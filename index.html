<!DOCTYPE HTML>
<html>
    <head>
        <title>Twitch Chat Spam Generator</title>
        <link rel="StyleSheet" href="css/bootstrap.css"/>
    </head>
    <body>
        <div align="center">
            <h1><img class="emote">Twitch Chat Spam Generator<img class="emote"></h1>
            <br>
            <input type="text" id="message" placeholder="Message" style="text-align: center"></input><br/><br/>
            <input type="text" id="emote" placeholder="Emote" style="text-align: center"></input><br/><br/>
            <button id="generate">Generate!</button><br/><br/>
            <input type="text" id="textout" style="text-align: center;" readonly placeholder="Output"></input>
        </div>
        
        <script src="jquery-2.1.4.min.js"></script>
        <script>
            function updateOutput(){
                msgval = $("#message").val();
                emoteval = $("#emote").val();
                
                if(msgval == "" || emoteval == "") return;
                
                output = "";
                for(var i = 0; i < msgval.length; i++) {
                    output += emoteval + " " + msgval[i].toUpperCase() + " ";
                }
                output += emoteval;
                $("#textout").val(output);
                $("#textout").focus();
                $("#textout").select();
                document.execCommand('copy');
            }
            
            $(document).ready(function(){
                $("#generate").mouseup(updateOutput);
                
                $.ajax({
                    url: 'https://twitchemotes.com/api_cache/v2/global.json',
                    success: function(json) {
                        var template = "https:" + json.template.medium;
                        var index = Math.floor(Math.random() * Object.keys(json.emotes).length);
                        var entry = json.emotes[Object.keys(json.emotes)[index]];
                        
                        var imgurl = template.replace("{image_id}", entry.image_id);
                        $(".emote").attr("src", imgurl);
                        console.log(imgurl);
                    }
                });
            });
        </script>
    </body>
</html>